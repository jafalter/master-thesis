In this chapter, we will define a variant of the adaptor signature scheme as explained in ~\cref{sec:pre:aptsignatures}.
This new variant is tailored specifically to meet the requirements of being applicable in the scenario of two-party signature protocols, constructable for aggregateable signature schemes such as schnorr~\cite{maxwell2019simple}.
In a two-party signature protocol each party holds only a share of a private key (to a composite public key) for which they want to cooperatively create a signature.
The advantage of our adapted signature scheme in comparison to the original definition is that in the two-party scenario mentioned above we do not need to introduce an additional pre-signature step.
Instead one of the partial signatures created and exchanged by the two parties will serve as the pre-signature allowing for a simpler protocol.
In particular our protocol will allow one of the two parties, to hide a witness value $\varWit \opIn (\varWit, \varStatement)$ inside his partial signature.
The second party (knowing $\varStatement$, but not $\varWit$) can verify that $\varWit$ is indeed contained in the partial signature received by the peer, and will furthermore be able to extract $\varWit$ from the final signature and the previously received partial signature.
This feature can then be leveraged to build an Atomic Swap protocol as we will show in ~\cref{ch:atomicswap}.

The rest of the chapter is organized as follows:
First we will define the general two-party schnorr signature protocol, as it is currently implemented in mimblewimble-based cryptocurrencies.
We will then show that the final signatures output by the protocol fulfill the same properties as regular schnorr signatures seen in ~\cite{schnorr1989efficient} and prove correctness of the protocol.
From this two-party protocol, we then derive the adapted variant already mentioned before.
We start by defining our extended signature scheme in ~\cref{sec:sig:definitions}, proceed by providing a schnorr-based instantiation of the protocol in ~\cref{sec:sig:schnorr-inst} and finally prove its security in ~\cref{sec:sig:two-party-apt-security}.

\section{Definitions} \label{sec:sig:definitions}
\input{chapters/multiparty_fixed_witness_adaptor_signatures/definitions}

\section{Schnorr-based instantiation} \label{sec:sig:schnorr-inst}
\input{chapters/multiparty_fixed_witness_adaptor_signatures/schnorr_based_instantiation}

\section{Correctness \& Security}\label{sec:sig:two-party-apt-security}
\input{chapters/multiparty_fixed_witness_adaptor_signatures/security_and_correctness}
