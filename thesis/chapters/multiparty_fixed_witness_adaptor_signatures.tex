In this chapter, we will define a variant of the adaptor signature scheme as explained in section ~\ref{sec:pre:aptsignatures}.
The main difference in the protocol outlined in this thesis is that one of the two parties does know the fixed secret witness before the start of the protocol.
The aim of the protocol will then be that the other person is able to extract the witness from the final signature.
This feature can then be leveraged to build an Atomic Swap protocol as we will show in ~\ref{ch:atomicswap}.


First we will define the general two-party signature creation protocol as it is currently implemented in Mimblewimble-based Cryptocurrencies.
We reduce the generated signatures to the general case~\cite{schnorr1989efficient} and prove its correctness.
From this two-party protocol, we then derive the adapted variant, which allows hiding a fixed witness value in the signature, which can be revealed only by the other party after attaining the final signature.


We start by defining our extended signature scheme in section~\ref{sec:sig:definitions}, proceed by providing a schnorr-based instantiation of the protocol in section~\ref{sec:sig:schnorr-inst} and finally prove its security in section~\ref{sec:sig:two-party-apt-security}.


\section{Definitions} \label{sec:sig:definitions}
\input{chapters/multiparty_fixed_witness_adaptor_signatures/definitions}

\section{Schnorr-based instantiation} \label{sec:sig:schnorr-inst}
\input{chapters/multiparty_fixed_witness_adaptor_signatures/schnorr_based_instantiation}

\section{Correctness \& Security}\label{sec:sig:two-party-apt-security}
\input{chapters/multiparty_fixed_witness_adaptor_signatures/security_and_correctness}
