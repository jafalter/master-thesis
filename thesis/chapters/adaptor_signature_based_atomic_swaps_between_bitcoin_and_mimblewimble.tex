In this section, we will formalize Mimblewimble transactions and define security properties, first found by Fuchsbauer et al. in~\cite{fuchsbauer2019aggregate} which have to hold for a valid transaction protocol.
We later provide two instantionons of the transaction protocol, $\cnstPayToCoin$ which is the general case transaction in which a sender wants to transfer some value to a receiver
and $\cnstPayToSharedCoin$, which is unique in that it creates coins which are only spendable by two (or more) parties collaborating. $\cnstPayToSharedCoin$ is similar
to a Mulit-signature transaction script in Bitcoin in which an UTXO, only spendable by a consortium of owners, is created.~\cite{bistarelli2018analysis}
We then prove that all security definitions for Mimblewimble transactions, hold for the outlined transaction protocols.
Finally we define a Atomic Swap protocol from these building blocks, which allows us to securely swap funds from a Mimblewimble blockchain with those on another Blockchain, such as Bitcoin.

\section{Definitions}\label{sec:atomic-def}

\begin{definition}[Mimblewimble Transaction Scheme]\label{def:tx}
    As we have already discussed in section~\ref{sec:Mimblewimble} for the creation of a transaction, it is immanent that both the sender and receiver collaborate and exchange messages via a secure channel.
    To construct the transaction protocol we assume that we have access to a two-party signature scheme as defined in definition~\ref{def:twoPartySig}, a zero-knowledge Rangeproofs system such as Bulletproofs, as
    described in section~\ref{sec:rangeProof}, a homomoprhic commitment scheme as defined in definition~\ref{def:homomorphicCom} such as Pedersen Commitments~\ref{def:pedersenCom}.
    A transaction scheme consist of the following two procedures:
    \[ \cnstTransaction \opAssign ( \procCreateOutputId \opSeperate \procSpendOutputId ) \]
    \begin{itemize}
        \item $\procCreateOutputId$
        \item $\procSpendOutputId$
    \end{itemize}
\end{definition}

TODO define security definitons

\section{Grin instantiation}\label{sec:atomic-inst}

In this section we describe instantiations for the transaction protocol defined in~\ref{def:tx} specifically tailored for the Grin cryptocurrency. We show that all of them are secure by proving the
outlined security properties for mimblewimble transactions. In section~\ref{sec:atomic-swap} we use this transaction types as building block for the Grin side of our Atomic Swap protocol.

\subsection{$\cnstPayToCoin$}

As homomorphic commitment scheme we here use the Pedersen Commitment as defined in definition~\ref{def:pedersenCom}, we also need a second simple commitment which we define as follows
$\procSimpleCommit \opEq \procCommit{0}{\varValue} \opEq \funGen{\varValue} \opAddPoint \funGenH{0} \opEq \funGen{\varValue}$. As Rangeproof scheme we use Bulletproofs as defined in
section~\ref{sec:rangeProof}. The instantiation of the transaction protocol can be seen in~\ref{fig:payToCoin}.
\begin{figure}
    \begin{center}
        \fbox{
        \begin{varwidth}{\textwidth}
            \procedure[linenumbering]{$\procCreateOutput{\varFundValue}{\varCoinInp}{\varBlindingFactor{ia}}$} {
                \varBlindingFactorFor{oa} \sample \cnstIntegersPrimeWithoutZero{\varPrime} \< \< \\
                \varCoinOutAlice \opFunResult \procCommit{\varValue \opSub \varFundValue}{\varBlindingFactorFor{oa}} \< \< \\
                \varProofAlice \opFunResult \procProof{\varCoinOutAlice}{\varValue \opSub \varFundValue}{\varBlindingFactorFor{oa}} \< \< \\
                \varBlindingFactorFor{sum} \opAssign \varBlindingFactorFor{\varBlindingFactorFor{oa} \opSub \varBlindingFactorFor{ia}} \< \< \\
                \varExcessAlice \opFunResult \procSimpleCommit{\varBlindingFactorFor{sum}} \< \< \\
                \varMsg \opAssign \cnstBinary{*} \\
                \varTx \opAssign (\varMsg \opSeperate \varCoinInp \opSeperate \varCoinOutAlice \opSeperate \varProofAlice \opSeperate \varExcessAlice) \< \< \\
                \< \sendmessageright*{\varTx} \< \\
                \< \< (\varMsg \opSeperate \varExcessAlice) \opFunResult \varTxAlice \\
                \< \< \varBlindingFactorFor{ob} \sample \cnstIntegersPrimeWithoutZero{\varPrime} \\
                \< \< \varCoinOutBob \opFunResult \procCommit{\varFundValue}{\varBlindingFactorFor{ob}} \\
                \< \< \varExcessBob \opFunResult \procSimpleCommit{\varBlindingFactorFor{ob}} \\
                \< \< \varSigBob \opFunResult \procSignPtSingle{\varMsg}{\varBlindingFactorFor{ob}} \\
                \< \< \varProofBob \opFunResult \procProof{\varCoinOutBob}{\varFundValue}{\varBlindingFactorFor{ob}} \\
                \< \< \varTx \opAssign \varTx \opConc (\varCoinOutBob \opConc \varExcessBob \opConc \varSigBob \opConc \varProofBob) \\
                \< \sendmessageleft*{\varTx} \< \\
                (\varSigBob \opSeperate \varExcessBob) \opFunResult \varTx \< \< \\
                \procVerfPtSig{\varSigBob}{\varMsg}{\varExcessAlice}{\varExcessBob} \opEq 1 \< \< \\
                \varSigAlice \opFunResult \procSignPtSingle{\varMsg}{\varBlindingFactorFor{sum}} \< \< \\
                \varSigFin \opFunResult \procFinSig{\varSigAlice}{\varSigBob} \< \< \\
                \pcreturn \varTx \opAssign \varTx \opConc \varSigFin
            }
        \end{varwidth}
        }
    \end{center}
    \caption{Instantiation of $\cnstPayToCoin$ transaction protocol.}
    \label{fig:payToCoin}
\end{figure}

\section{Atomic Swap protocol}\label{sec:atomic-swap}